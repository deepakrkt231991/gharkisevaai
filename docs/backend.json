
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the GrihSeva AI app.",
      "properties": {
        "uid": {
          "type": "string",
          "description": "Firebase Authentication user ID."
        },
        "name": {
          "type": "string",
          "description": "User's full name."
        },
        "phone": {
          "type": "string",
          "description": "User's phone number."
        },
        "address": {
          "type": "string",
          "description": "User's address."
        },
        "userType": {
          "type": "string",
          "description": "Type of user.",
          "enum": ["customer", "worker", "doctor"]
        },
        "referredBy": {
          "type": "string",
          "description": "The ID of the user or worker who referred this user."
        },
        "walletBalance": {
            "type": "number",
            "description": "The balance of referral earnings for the user."
        }
      },
      "required": ["uid", "userType"]
    },
    "Job": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Job",
      "type": "object",
      "description": "Represents a job booking in the GrihSeva AI app.",
      "properties": {
        "jobId": {
          "type": "string",
          "description": "Unique identifier for the job."
        },
        "customerId": {
          "type": "string",
          "description": "ID of the customer who created the job."
        },
        "workerId": {
            "type": "string",
            "description": "ID of the worker assigned to the job."
        },
        "problem_image_url": {
          "type": "string",
          "description": "URL of the uploaded problem image."
        },
        "completion_image_url": {
            "type": "string",
            "description": "URL of the image uploaded by the worker upon completion."
        },
        "ai_diagnosis": {
          "type": "string",
          "description": "Diagnosis provided by the AI."
        },
        "estimated_cost": {
          "type": "string",
          "description": "Estimated cost provided by the AI."
        },
        "final_cost": {
            "type": "number",
            "description": "The final agreed-upon cost for the job."
        },
        "paymentId": {
            "type": "string",
            "description": "ID of the payment transaction from the payment gateway."
        },
        "paymentStatus": {
            "type": "string",
            "enum": ["pending", "held_in_escrow", "paid_to_worker", "refunded"],
            "description": "The status of the payment."
        },
        "status": {
          "type": "string",
          "description": "Current status of the job.",
          "enum": ["pending_diagnosis", "awaiting_payment", "worker_assigned", "in_progress", "pending_confirmation", "completed", "disputed", "cancelled"]
        },
        "otp": {
          "type": "string",
          "description": "A one-time password sent to the user to verify the start of the job."
        }
      },
      "required": ["jobId", "customerId", "status"]
    },
    "Worker": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Worker",
      "type": "object",
      "description": "Represents a service worker.",
      "properties": {
        "uid": {
          "type": "string",
          "description": "Firebase Authentication user ID."
        },
        "workerId": {
          "type": "string",
          "description": "Unique identifier for the worker (same as their uid)."
        },
        "skills": {
          "type": "array",
          "items": { "type": "string" },
          "description": "List of worker's skills (e.g., plumber, electrician)."
        },
        "rating": {
          "type": "number",
          "description": "Average rating of the worker."
        },
        "location": {
          "type": "object",
          "properties": {
            "latitude": { "type": "number" },
            "longitude": { "type": "number" }
          },
          "description": "Geographical location of the worker."
        },
        "isVerified": {
          "type": "boolean",
          "description": "Whether the worker is verified."
        },
        "bankDetails": {
            "type": "object",
            "description": "Bank account details for payouts.",
            "properties": {
                "accountNumber": { "type": "string" },
                "ifscCode": { "type": "string" },
                "accountHolderName": { "type": "string"}
            }
        },
        "referredBy": {
            "type": "string",
            "description": "The ID of the user or worker who referred this worker."
        },
        "walletBalance": {
            "type": "number",
            "description": "The balance of referral earnings for the worker."
        }
      },
      "required": ["uid", "workerId", "isVerified"]
    },
    "Health": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Health",
      "type": "object",
      "description": "Stores appliance health and AMC data for a user.",
      "properties": {
        "userId": {
          "type": "string",
          "description": "ID of the user this record belongs to."
        },
        "appliance_name": {
          "type": "string",
          "description": "Name of the appliance (e.g., AC, Fridge)."
        },
        "last_service_date": {
          "type": "string",
          "format": "date",
          "description": "Last service date of the appliance."
        },
        "next_service_due_date": {
          "type": "string",
          "format": "date-time",
          "description": "Next scheduled service date."
        },
        "amc_status": {
            "type": "string",
            "enum": ["active", "inactive"],
            "description": "Status of the Annual Maintenance Contract."
        }
      },
      "required": ["userId", "appliance_name"]
    },
    "Tool": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Tool",
      "type": "object",
      "description": "Represents a tool available for rent.",
      "properties": {
        "toolId": { "type": "string" },
        "ownerId": { "type": "string", "description": "The worker ID of the tool owner." },
        "name": { "type": "string" },
        "description": { "type": "string" },
        "rental_price_per_day": { "type": "number" },
        "is_available": { "type": "boolean" }
      },
      "required": ["toolId", "ownerId", "name", "rental_price_per_day"]
    },
    "Rental": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Rental",
      "type": "object",
      "description": "Represents a tool rental transaction.",
      "properties": {
        "rentalId": { "type": "string" },
        "toolId": { "type": "string" },
        "renterId": { "type": "string", "description": "The user ID of the person renting the tool." },
        "startDate": { "type": "string", "format": "date" },
        "endDate": { "type": "string", "format": "date" },
        "status": { "type": "string", "enum": ["requested", "active", "completed", "cancelled"] }
      },
      "required": ["rentalId", "toolId", "renterId", "startDate"]
    },
    "Transaction": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Transaction",
      "type": "object",
      "description": "Represents a single financial transaction in a user's or worker's wallet.",
      "properties": {
        "transactionId": { "type": "string" },
        "userId": { "type": "string", "description": "The ID of the user/worker who this transaction belongs to." },
        "amount": { "type": "number" },
        "type": { "type": "string", "enum": ["referral_commission", "payout", "refund"] },
        "sourceJobId": { "type": "string", "description": "The job ID that triggered this transaction." },
        "timestamp": { "type": "string", "format": "date-time" }
      },
      "required": ["transactionId", "userId", "amount", "type"]
    },
    "SOSAlert": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SOSAlert",
      "type": "object",
      "description": "Represents an emergency SOS alert.",
      "properties": {
        "alertId": { "type": "string" },
        "userId": { "type": "string", "description": "The ID of the user/worker who triggered the alert." },
        "location": {
          "type": "object",
          "properties": {
            "latitude": { "type": "number" },
            "longitude": { "type": "number" }
          },
          "description": "Geographical location where the alert was triggered."
        },
        "timestamp": { "type": "string", "format": "date-time" },
        "status": { "type": "string", "enum": ["active", "resolved"] },
        "audio_url": { "type": "string", "description": "URL of the background audio recording."}
      },
      "required": ["alertId", "userId", "location", "timestamp", "status"]
    },
    "AppSettings": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "App Settings",
      "type": "object",
      "description": "Stores global app settings, like dynamic banner content.",
      "properties": {
        "content": { "type": "string", "description": "लाइफटाइम कमाई! हर रेफरल पर 0.05% कमीशन पाएं।\\nLifetime Earnings! Get 0.05% commission on every referral." },
        "style": { "type": "string", "description": "dynamic_card" },
        "backgroundColor": { "type": "string", "description": "#FFD700" },
        "lastUpdated": { "type": "string", "format": "date-time" }
      }
    },
    "LegalAgreement": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Legal Agreement",
      "type": "object",
      "description": "Represents a legally binding digital agreement for a deal.",
      "properties": {
        "agreementId": { "type": "string", "description": "Unique ID for the agreement." },
        "dealId": { "type": "string", "description": "The associated Deal ID." },
        "buyerId": { "type": "string" },
        "sellerId": { "type": "string" },
        "buyerName": { "type": "string" },
        "sellerName": { "type": "string" },
        "itemName": { "type": "string" },
        "itemCondition": { "type": "string" },
        "finalPrice": { "type": "number" },
        "status": { "type": "string", "enum": ["active", "completed"] },
        "createdAt": { "type": "string", "format": "date-time", "description": "Firestore Timestamp of when the agreement was created." }
      },
      "required": ["agreementId", "dealId", "buyerId", "sellerId", "itemName", "finalPrice", "status", "createdAt"]
    },
    "Property": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Property",
      "type": "object",
      "description": "Represents a property listing in the marketplace.",
      "properties": {
        "propertyId": { "type": "string", "description": "Unique ID for the property." },
        "ownerId": { "type": "string", "description": "The user ID of the person who listed the property." },
        "title": { "type": "string", "description": "Title of the listing, e.g., '4 BHK Luxury Suite'." },
        "location": { "type": "string", "description": "City and area, e.g., 'Worli, Mumbai'." },
        "geo": {
          "type": "object",
          "description": "Geographical coordinates of the property.",
          "properties": {
            "latitude": { "type": "number" },
            "longitude": { "type": "number" }
          }
        },
        "price": { "type": "number", "description": "Price in a numerical format (e.g., 4.20 for crores)." },
        "priceUnit": { "type": "string", "description": "Unit for the price, e.g., 'Cr'." },
        "sqft": { "type": "number" },
        "parking": { "type": "number" },
        "imageUrl": { "type": "string" },
        "isAiVerified": { "type": "boolean", "description": "Whether the property has been verified by AI." }
      },
      "required": ["propertyId", "ownerId", "title", "location", "price", "priceUnit", "sqft", "parking"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous",
      "phone",
      "google.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": { "$ref": "#/backend/entities/User" },
          "description": "Stores user profiles."
        }
      },
      {
        "path": "/jobs/{jobId}",
        "definition": {
          "entityName": "Job",
          "schema": { "$ref": "#/backend/entities/Job" },
          "description": "Stores details of all jobs."
        }
      },
      {
        "path": "/workers/{workerId}",
        "definition": {
          "entityName": "Worker",
          "schema": { "$ref": "#/backend/entities/Worker" },
          "description": "Stores public profiles for verified workers."
        }
      },
      {
        "path": "/health/{healthId}",
        "definition": {
          "entityName": "Health",
          "schema": { "$ref": "#/backend/entities/Health" },
          "description": "Stores appliance health and AMC data for users."
        }
      },
      {
        "path": "/tools/{toolId}",
        "definition": {
          "entityName": "Tool",
          "schema": { "$ref": "#/backend/entities/Tool" },
          "description": "Stores tools available for rent by workers."
        }
      },
      {
        "path": "/rentals/{rentalId}",
        "definition": {
          "entityName": "Rental",
          "schema": { "$ref": "#/backend/entities/Rental" },
          "description": "Stores tool rental transactions."
        }
      },
      {
        "path": "/transactions/{transactionId}",
        "definition": {
          "entityName": "Transaction",
          "schema": { "$ref": "#/backend/entities/Transaction" },
          "description": "Stores wallet transactions like referral commissions."
        }
      },
      {
        "path": "/sos_alerts/{alertId}",
        "definition": {
          "entityName": "SOSAlert",
          "schema": { "$ref": "#/backend/entities/SOSAlert" },
          "description": "Stores emergency SOS alerts."
        }
      },
       {
        "path": "/app_settings/{docId}",
        "definition": {
          "entityName": "AppSettings",
          "schema": { "$ref": "#/backend/entities/AppSettings" },
          "description": "Stores global app settings, like dynamic content for banners. The docId 'top_banner' is used for the main promotional banner."
        }
      },
      {
        "path": "/legal_agreements/{agreementId}",
        "definition": {
          "entityName": "LegalAgreement",
          "schema": { "$ref": "#/backend/entities/LegalAgreement" },
          "description": "Stores all generated legal agreements for deals."
        }
      },
      {
        "path": "/properties/{propertyId}",
        "definition": {
          "entityName": "Property",
          "schema": { "$ref": "#/backend/entities/Property" },
          "description": "Stores property listings for the marketplace."
        }
      }
    ]
  }
}
